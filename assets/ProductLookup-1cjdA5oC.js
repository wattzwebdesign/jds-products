import{u as U,r,c as q,o as D,a as V,A as N,b as o,y as F,d as s,h as c,x as L,i as A,v as R,t as n,s as E,z as I,F as K,k as T,p as w,C as $,m as z,q as u}from"./index-DkDiu1Kn.js";import{P as Q}from"./ProductCard-C_gbQgD-.js";import{A as W}from"./AppHeader-CPdlpKI8.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";const H={class:"product-lookup"},X={class:"main-content"},G={class:"search-section"},J=["disabled"],O={key:0,class:"error-message"},Y={key:1,class:"warning-message"},Z={key:0,class:"results-section"},ee={class:"results-header"},se={class:"results-count"},te={key:0,class:"save-section"},ae={class:"save-info"},le=["disabled"],oe={class:"products-grid"},ne={key:0,class:"database-badge not-in-db"},ue={key:1,class:"database-badge in-db"},re={key:1,class:"no-results"},ie={key:0,class:"loading-live"},de={key:1,class:"live-product-details"},ce={class:"sku"},ve={class:"inventory-section"},pe={class:"inventory-grid"},he={class:"inventory-item"},ye={class:"value"},fe={class:"inventory-item"},ge={class:"value"},me={key:0,class:"pricing-section"},_e={class:"pricing-grid"},ke={class:"price-item"},we={class:"value"},be={__name:"ProductLookup",setup(Pe){const b=z(),v=V();U();const m=r(""),i=r([]),y=r(null),_=r(""),f=r(!1),P=r(!1),k=r(!1),d=r(null),p=q(()=>i.value.filter(t=>!t.inDatabase)),C=async()=>{_.value="",d.value=null,f.value=!0,P.value=!0;try{const t=await w.lookupBySKUs(m.value);y.value=t,i.value=t.products||[],window.fathom&&t.requestedCount&&window.fathom.trackEvent("SKU Lookup",{_site_id:"UMVXBRTN",_value:t.requestedCount})}catch(t){_.value=t.response?.data?.error||"Failed to search products. Please try again.",i.value=[]}finally{f.value=!1}},B=async()=>{k.value=!0,d.value=null;try{const t=p.value.map(a=>a.sku),e=await $.addMissingProducts(t);d.value=e,e.success&&(i.value=i.value.map(a=>t.includes(a.sku)?{...a,inDatabase:!0}:a))}catch(t){d.value={success:!1,message:t.response?.data?.error||"Failed to save products. Please try again."}}finally{k.value=!1}},h=r(null),l=r(null),g=r(!1),M=async t=>{const e={...v.query,sku:t.sku};b.push({query:e}),h.value=t,g.value=!0,l.value=null;try{const a=await w.getLiveProduct(t.sku);l.value=a.product,window.fathom&&window.fathom.trackPageview({url:window.location.origin+v.fullPath})}catch(a){console.error("Failed to fetch live product:",a),l.value=t}finally{g.value=!1}},S=()=>{h.value=null,l.value=null;const t={...v.query};delete t.sku,b.push({query:t})},x=async t=>{if(t)try{let e=i.value.find(a=>a.sku===t);if(e||(e=(await w.getLiveProduct(t)).product),e){h.value=e,g.value=!0,l.value=null;try{const a=await w.getLiveProduct(t);l.value=a.product,window.fathom&&window.fathom.trackPageview({url:window.location.origin+v.fullPath})}catch(a){console.error("Failed to fetch live product:",a),l.value=e}finally{g.value=!1}}}catch(e){console.error("Failed to open product modal from URL:",e)}};return D(()=>{const t=v.query.sku;t&&x(t)}),N(()=>v.query.sku,(t,e)=>{t!==e&&(t?x(t):!t&&h.value&&(h.value=null,l.value=null))}),(t,e)=>(u(),o("div",H,[F(W),s("main",X,[s("div",G,[e[3]||(e[3]=s("h2",null,"Enter SKU Codes",-1)),e[4]||(e[4]=s("p",{class:"search-instructions"}," Enter one or more SKU codes (comma-separated, space-separated, or on separate lines) ",-1)),s("form",{onSubmit:L(C,["prevent"])},[A(s("textarea",{"onUpdate:modelValue":e[0]||(e[0]=a=>m.value=a),placeholder:`Example: LPB004, LWB101
or
LPB004
LWB101`,rows:"4",class:"sku-input"},null,512),[[R,m.value]]),s("button",{type:"submit",class:"btn btn-primary",disabled:f.value||!m.value.trim()},n(f.value?"Searching...":"Search Products"),9,J)],32),_.value?(u(),o("div",O,n(_.value),1)):c("",!0),y.value&&y.value.notFound&&y.value.notFound.length>0?(u(),o("div",Y,[e[2]||(e[2]=s("strong",null,"Not Found:",-1)),E(" "+n(y.value.notFound.join(", ")),1)])):c("",!0)]),i.value.length>0?(u(),o("div",Z,[s("div",ee,[e[5]||(e[5]=s("h2",null,"Results",-1)),s("span",se,n(i.value.length)+" product"+n(i.value.length!==1?"s":"")+" found",1)]),p.value.length>0?(u(),o("div",te,[s("div",ae,[e[6]||(e[6]=s("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[s("circle",{cx:"12",cy:"12",r:"10","stroke-width":"2"}),s("line",{x1:"12",y1:"8",x2:"12",y2:"12","stroke-width":"2","stroke-linecap":"round"}),s("line",{x1:"12",y1:"16",x2:"12.01",y2:"16","stroke-width":"2","stroke-linecap":"round"})],-1)),s("span",null,n(p.value.length)+" product"+n(p.value.length!==1?"s":"")+" not in database",1)]),s("button",{onClick:B,class:"btn btn-save",disabled:k.value},n(k.value?"Saving...":`Save ${p.value.length} Missing Product${p.value.length!==1?"s":""}`),9,le)])):c("",!0),d.value?(u(),o("div",{key:1,class:I(["save-result",d.value.success?"success":"error"])},[s("strong",null,n(d.value.success?"✓ Success":"✗ Error"),1),s("p",null,n(d.value.message),1)],2)):c("",!0),s("div",oe,[(u(!0),o(K,null,T(i.value,a=>(u(),o("div",{key:a.sku,class:"product-wrapper"},[a.inDatabase?(u(),o("div",ue," In Database ")):(u(),o("div",ne," Not in Database ")),F(Q,{product:a,onViewDetails:Se=>M(a)},null,8,["product","onViewDetails"])]))),128))])])):P.value&&!f.value?(u(),o("div",re,[...e[7]||(e[7]=[s("p",null,"No products found. Please check your SKU codes and try again.",-1)])])):c("",!0)]),h.value?(u(),o("div",{key:0,class:"modal-overlay",onClick:S},[s("div",{class:"modal-content",onClick:e[1]||(e[1]=L(()=>{},["stop"]))},[s("button",{onClick:S,class:"modal-close"},"×"),g.value?(u(),o("div",ie,[...e[8]||(e[8]=[s("div",{class:"spinner"},null,-1),s("p",null,"Fetching live inventory & pricing...",-1)])])):l.value?(u(),o("div",de,[s("h2",null,n(l.value.name),1),s("p",ce,"SKU: "+n(l.value.sku),1),s("div",ve,[e[11]||(e[11]=s("h3",null,"Inventory",-1)),s("div",pe,[s("div",he,[e[9]||(e[9]=s("span",{class:"label"},"Available:",-1)),s("span",ye,n(l.value.availability?.available||0),1)]),s("div",fe,[e[10]||(e[10]=s("span",{class:"label"},"Local:",-1)),s("span",ge,n(l.value.availability?.local||0),1)])])]),l.value.pricing?(u(),o("div",me,[e[13]||(e[13]=s("h3",null,"Pricing",-1)),s("div",_e,[s("div",ke,[e[12]||(e[12]=s("span",{class:"label"},"Price:",-1)),s("span",we,"$"+n(l.value.pricing?.price?.toFixed(2)||"0.00"),1)])])])):c("",!0)])):c("",!0)])])):c("",!0)]))}},Be=j(be,[["__scopeId","data-v-7af2c85d"]]);export{Be as default};
