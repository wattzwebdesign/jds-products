import{u as D,r as n,j as Q,c as a,a as t,b as h,f as L,g as j,h as K,t as d,k as O,d as m,v as R,l as q,e as x,m as T,F as E,n as J,w as W,p as V,i as z,o as l,q as G}from"./index-DoJVvKji.js";import{P as B}from"./ProductCard-Dg3evptP.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";const X={class:"product-search"},Y={class:"header"},Z={class:"header-content"},ee={class:"user-info"},te={class:"main-content"},oe={class:"search-header"},le={class:"search-box"},se={key:0,class:"filters-panel"},ae={class:"filter-group"},ne={class:"filter-group"},re={key:1,class:"loading"},ie={key:2,class:"error-message"},ue={key:3},de={class:"results-header"},ce={class:"results-count"},ve={class:"products-grid"},pe={key:0,class:"pagination"},he=["disabled"],ke={class:"page-info"},ge=["disabled"],ye={key:4,class:"no-results"},be={key:5,class:"welcome"},fe={key:0,class:"loading-live"},me={key:1},xe={__name:"ProductSearch",setup(Se){const N=z(),S=D(),k=n(""),i=n({inStock:!1,localStock:!1}),g=n(!1),v=n([]),o=n({page:1,limit:20,total:0,totalPages:0}),y=n(!1),w=n(!1),p=n(""),b=n(null),u=n(null),f=n(!1);let _=null;const c=async(r=1)=>{y.value=!0,p.value="",w.value=!0;try{const e=await V.search(k.value,i.value,r,o.value.limit);v.value=e.products||[],o.value=e.pagination||o.value}catch(e){p.value=e.response?.data?.message||"Search failed. Please try again.",v.value=[]}finally{y.value=!1}},M=()=>{clearTimeout(_),_=setTimeout(()=>{c(1)},500)},C=()=>{c(1)},I=()=>{i.value={inStock:!1,localStock:!1},c(1)},P=r=>{r>=1&&r<=o.value.totalPages&&(c(r),window.scrollTo({top:0,behavior:"smooth"}))},U=async r=>{b.value=r,f.value=!0,u.value=null;try{const e=await V.getLiveProduct(r.sku);u.value=e.product}catch(e){console.error("Failed to fetch live product:",e),u.value=r}finally{f.value=!1}},F=()=>{b.value=null,u.value=null},A=()=>{S.logout(),N.push("/login")};return Q(()=>{c(1)}),(r,e)=>{const $=K("router-link");return l(),a("div",X,[t("header",Y,[t("div",Z,[e[8]||(e[8]=t("h1",null,"JDS Product Search",-1)),t("div",ee,[L($,{to:"/admin",class:"btn btn-admin"},{default:j(()=>[...e[7]||(e[7]=[x("⚙ Admin",-1)])]),_:1}),t("span",null,d(O(S).user?.username),1),t("button",{onClick:A,class:"btn btn-logout"},"Logout")])])]),t("main",te,[t("div",oe,[t("div",le,[m(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>k.value=s),onInput:M,type:"text",placeholder:"Search by product name, description, or SKU...",class:"search-input"},null,544),[[R,k.value]]),e[9]||(e[9]=t("svg",{class:"search-icon",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[t("circle",{cx:"11",cy:"11",r:"8","stroke-width":"2"}),t("path",{d:"m21 21-4.35-4.35","stroke-width":"2","stroke-linecap":"round"})],-1))]),t("button",{onClick:e[1]||(e[1]=s=>g.value=!g.value),class:"btn btn-filter"},[...e[10]||(e[10]=[q('<svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" data-v-b63a5995><line x1="4" y1="21" x2="4" y2="14" stroke-width="2" stroke-linecap="round" data-v-b63a5995></line><line x1="4" y1="10" x2="4" y2="3" stroke-width="2" stroke-linecap="round" data-v-b63a5995></line><line x1="12" y1="21" x2="12" y2="12" stroke-width="2" stroke-linecap="round" data-v-b63a5995></line><line x1="12" y1="8" x2="12" y2="3" stroke-width="2" stroke-linecap="round" data-v-b63a5995></line><line x1="20" y1="21" x2="20" y2="16" stroke-width="2" stroke-linecap="round" data-v-b63a5995></line><line x1="20" y1="12" x2="20" y2="3" stroke-width="2" stroke-linecap="round" data-v-b63a5995></line><line x1="1" y1="14" x2="7" y2="14" stroke-width="2" stroke-linecap="round" data-v-b63a5995></line><line x1="9" y1="8" x2="15" y2="8" stroke-width="2" stroke-linecap="round" data-v-b63a5995></line><line x1="17" y1="16" x2="23" y2="16" stroke-width="2" stroke-linecap="round" data-v-b63a5995></line></svg> Filters ',2)])])]),g.value?(l(),a("div",se,[t("div",ae,[t("label",null,[m(t("input",{type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=s=>i.value.inStock=s),onChange:C},null,544),[[T,i.value.inStock]]),e[11]||(e[11]=x(" In Stock Only (Available Qty > 0) ",-1))])]),t("div",ne,[t("label",null,[m(t("input",{type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=s=>i.value.localStock=s),onChange:C},null,544),[[T,i.value.localStock]]),e[12]||(e[12]=x(" Local Stock Only (Local Qty > 0) ",-1))])]),t("button",{onClick:I,class:"btn btn-clear"},"Clear Filters")])):h("",!0),y.value?(l(),a("div",re,[...e[13]||(e[13]=[t("div",{class:"spinner"},null,-1),t("p",null,"Searching products...",-1)])])):p.value?(l(),a("div",ie,d(p.value),1)):v.value.length>0?(l(),a("div",ue,[t("div",de,[e[14]||(e[14]=t("h2",null,"Search Results",-1)),t("span",ce,d(o.value.total?.toLocaleString()||0)+" product"+d(o.value.total!==1?"s":"")+" found ",1)]),t("div",ve,[(l(!0),a(E,null,J(v.value,s=>(l(),G(B,{key:s.sku,product:s,onClick:we=>U(s)},null,8,["product","onClick"]))),128))]),o.value.totalPages>1?(l(),a("div",pe,[t("button",{onClick:e[4]||(e[4]=s=>P(o.value.page-1)),disabled:o.value.page===1,class:"btn btn-page"}," ← Previous ",8,he),t("span",ke," Page "+d(o.value.page)+" of "+d(o.value.totalPages),1),t("button",{onClick:e[5]||(e[5]=s=>P(o.value.page+1)),disabled:o.value.page>=o.value.totalPages,class:"btn btn-page"}," Next → ",8,ge)])):h("",!0)])):w.value?(l(),a("div",ye,[...e[15]||(e[15]=[t("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"},[t("circle",{cx:"11",cy:"11",r:"8","stroke-width":"2"}),t("path",{d:"m21 21-4.35-4.35","stroke-width":"2","stroke-linecap":"round"})],-1),t("p",null,"No products found",-1),t("span",null,"Try adjusting your search or filters",-1)])])):(l(),a("div",be,[...e[16]||(e[16]=[t("h2",null,"Welcome to Product Search",-1),t("p",null,"Search through thousands of products by name, description, or SKU",-1)])]))]),b.value?(l(),a("div",{key:0,class:"modal-overlay",onClick:F},[t("div",{class:"modal-content",onClick:e[6]||(e[6]=W(()=>{},["stop"]))},[t("button",{onClick:F,class:"modal-close"},"×"),f.value?(l(),a("div",fe,[...e[17]||(e[17]=[t("div",{class:"spinner"},null,-1),t("p",null,"Fetching live data...",-1)])])):u.value?(l(),a("div",me,[L(B,{product:u.value,detailed:!0},null,8,["product"])])):h("",!0)])])):h("",!0)])}}},Fe=H(xe,[["__scopeId","data-v-b63a5995"]]);export{Fe as default};
